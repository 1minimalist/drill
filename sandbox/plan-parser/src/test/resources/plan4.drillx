%1    := scan-json “table-1”
%2   := bind “y”, %1
%3   := bind “z”, %1
%4,%5 := group %1, %2, %3         # group by y, z, group ref in %5
%6    := explode %4, %5           # aggregate on group value
%7    := bind “x”, %6             # sum(x), note where ref is bound
%8    := aggregate “sum”, %6, %7
%9,%10:= flatten %4, %8           # splice result back into data
%11   := as %10, “s”, %9          # name the aggregated result
%12   := bind “s”, %11
%13   := bind “y”, %11
%14   := bind “z”, %11
%14   := project %11, %12, %13, %14   # select s,y,z
